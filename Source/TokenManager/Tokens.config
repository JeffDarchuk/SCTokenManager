<?xml version="1.0"?>
<configuration xmlns:patch="http://www.sitecore.net/xmlconfig/">
	<sitecore>
		<events>
			<event name="item:saved">
				<handler type="TokenManager.Pipelines.Saved.TokenSaved, TokenManager" method="OnItemSaved"/>
			</event>
			<event name="item:deleting">
				<handler type="TokenManager.Pipelines.Deleting.TokenDeleting, TokenManager" method="OnItemDeleting"/>
			</event>
			<event name="item:moved">
				<handler type="TokenManager.Pipelines.Moved.TokenMoved, TokenManager" method="OnItemMoved"/>
			</event>
		</events>
		<pipelines>
			<initialize>
				<processor type="TokenManager.Pipelines.Initialize.InitializeTokenManager, TokenManager" >
					<Tokens type="TokenManager.Management.DefaultTokenKeeperService, TokenManager">
						<param name="TokenCss">font-style: italic;background-color: #A0FFD9;text-decoration: none;</param>
          </Tokens>
				</processor>
			</initialize>
			<renderField>
				<processor patch:instead="*[@type='Sitecore.Pipelines.RenderField.GetTextFieldValue, Sitecore.Kernel']"
									 type="TokenManager.Pipelines.RenderField.RenderFieldExpandTokens, TokenManager">
				</processor>
			</renderField>
			<getTokenGroup>
				<processor type="TokenManager.Pipelines.GetTokenGroup.GetSitecoreGroup, TokenManager" ></processor>
				<processor type="TokenManager.Pipelines.GetTokenGroup.GetDynamicGroup, TokenManager" ></processor>
				<processor type="TokenManager.Pipelines.GetTokenGroup.GetRuleTokenGroup, TokenManager"></processor>
        <processor type="TokenManager.Pipelines.GetTokenGroup.GetSharedLinkGroup, TokenManager"></processor>
        <processor type="TokenManager.Pipelines.GetTokenGroup.GetRenderingTokenGroup, TokenManager" ></processor>
      </getTokenGroup>
    </pipelines>
		<clientscripts>
			<htmleditor>
				<script src="/TokenManager/TokenSelectorCommand.js" language="JavaScript"/>
			</htmleditor>
		</clientscripts>
		<contentSearch>
			<indexConfigurations>
				<defaultLuceneIndexConfiguration>
					<fields hint="raw:AddComputedIndexField">
						<field fieldName="_tokens" storageType="yes" indexType="untokenized">TokenManager.ContentSearch.Tokens, TokenManager</field>
					</fields>
				</defaultLuceneIndexConfiguration>
			</indexConfigurations>
		</contentSearch>
	</sitecore>
</configuration>